(this.webpackJsonpoms=this.webpackJsonpoms||[]).push([[16],{470:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return c})),a.d(t,"c",(function(){return i})),a.d(t,"e",(function(){return o})),a.d(t,"b",(function(){return u}));var n=a(62),r=function(e){return n.a.get("/department",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))},c=function(e){return n.a.post("/department",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))},i=function(e){return n.a.put("/department",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))},o=function(e){return Promise.resolve(e),n.a.put("/department/setManage",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))},u=function(e){return n.a.delete("/department",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))}},708:function(e,t,a){"use strict";a.r(t);var n=a(170),r=a(49),c=a.n(r),i=a(71),o=a(89),u=a(0),s=a.n(u),l=a(47),m=a(553),d=a(436),f=a(68),p=a(437),g=a(439),h=a(38),v=a(171),b=a(470),O=m.a.Option;t.default=Object(l.g)((function(e){var t=e.location,a=e.history,r=Object(u.useState)(""),l=Object(o.a)(r,2),E=l[0],j=l[1],x=Object(u.useState)(""),w=Object(o.a)(x,2),k=w[0],I=w[1],P=Object(u.useState)([]),T=Object(o.a)(P,2),B=T[0],C=T[1],y=s.a.createRef(),S=function(){var e=Object(i.a)(c.a.mark((function e(){var t,a,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.d)();case 2:t=e.sent,a=t.code,n=t.data,C(1===a?n:[]);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=Object(i.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.departmentId&&(t.departmentName=B.filter((function(e){return e._id===t.departmentId}))[0].name),d.a.confirm({title:k?"\u786e\u5b9a\u4fee\u6539\u8d26\u6237\u4fe1\u606f\u5417\uff1f":"\u786e\u5b9a\u521b\u5efa\u4e00\u4e2a\u65b0\u8d26\u6237\u5417\uff1f",onOk:function(){var e=Object(i.a)(c.a.mark((function e(){var a,r,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!k){e.next=6;break}return e.next=3,Object(v.f)(Object(n.a)({},t,{id:k}));case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,Object(v.a)(t);case 8:e.t0=e.sent;case 9:a=e.t0,r=a.code,i=a.msg,1===r?t.departmentId?(F(),f.a.success(i)):(f.a.success("\u5bc6\u7801\u4fee\u6539\u6210\u529f\uff0c\u5373\u5c06\u8df3\u8f6c\u5230\u767b\u5f55\u9875"),setTimeout((function(){window.location.href="/admin/login",localStorage.clear()}),1500)):f.a.error(i);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),onCancel:function(){f.a.warning("\u64cd\u4f5c\u5df2\u53d6\u6d88")}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){y.current.resetFields(),I(""),j("")},F=function(){N(),a.goBack()},_=function(e){I(e._id),y.current.setFieldsValue(Object(n.a)({},e))};return Object(u.useEffect)((function(){var e=localStorage.getItem("role");j(e)}),[E]),Object(u.useEffect)((function(){N()}),[t.pathname]),Object(u.useEffect)((function(){S()}),[]),Object(u.useEffect)((function(){if(t.pathname.indexOf("/user/edit")>-1){var e=JSON.parse(localStorage.getItem("userInfo"));_(e)}if(t.pathname.indexOf("/manage/edit")>-1){var n=t.query;if(n){var r=n.info;_(r)}else a.push("./add")}}),[t.pathname]),s.a.createElement("div",null,s.a.createElement("div",{className:"container"},s.a.createElement(p.a,Object.assign({},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:8}}},{ref:y,onFinish:q}),s.a.createElement(p.a.Item,{name:"username",label:"\u7528\u6237\u540d",validateTrigger:["onBlur","onChange"],rules:[{validator:function(e,t){return t?/[\u4E00-\u9FA5]/g.test(t)?Promise.reject("\u4e0d\u80fd\u8f93\u5165\u6c49\u5b57!"):Promise.resolve():Promise.reject("\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a")},validateTrigger:"onBlur"}],required:!0},s.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"})),s.a.createElement(p.a.Item,{name:"nickName",label:"\u6635\u79f0",validateTrigger:["onBlur","onChange"],rules:[{required:!0,message:"\u4e3a\u4e86\u65b9\u4fbf\u533a\u5206\uff0c\u8bf7\u4e3a\u8d26\u6237\u8bbe\u7f6e\u6635\u79f0(\u53ef\u4ee5\u7528\u4e2d\u6587)",validateTrigger:"onBlur"}]},s.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u6635\u79f0"})),t.pathname.indexOf("/user/edit")>-1?s.a.createElement(p.a.Item,{name:"password",label:"\u65b0\u5bc6\u7801",validateTrigger:["onBlur"],rules:[{min:9,max:16,message:"\u5bc6\u7801\u957f\u5ea6\u57289~16\u4f4d\u4e4b\u95f4",validateTrigger:["onBlur"]}]},s.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u65b0\u5bc6\u7801"})):s.a.createElement(p.a.Item,{name:"password",label:"\u5bc6\u7801",validateTrigger:["onBlur","onChange"],rules:[{required:!0,message:"\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a",validateTrigger:"onBlur"},{min:9,max:16,message:"\u5bc6\u7801\u957f\u5ea6\u57289~16\u4f4d\u4e4b\u95f4",validateTrigger:["onBlur","onChange"]}]},s.a.createElement(g.a,{disabled:!!k,placeholder:"\u8f93\u5165\u5bc6\u7801"})),s.a.createElement(p.a.Item,{name:"remarks",label:"\u5907\u6ce8",rules:[{required:!0,message:"\u5907\u6ce8\u4e0d\u80fd\u4e3a\u7a7a"}]},s.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u5907\u6ce8"})),-1===t.pathname.indexOf("/user/edit")&&s.a.createElement(p.a.Item,{label:"\u90e8\u95e8",name:"departmentId",validateTrigger:["onBlur","onChange"],rules:[{required:!0,message:"\u8bf7\u4e3a\u8be5\u8d26\u6237\u8bbe\u7f6e\u90e8\u95e8",validateTrigger:"onBlur"}]},s.a.createElement(m.a,{placeholder:"\u8bf7\u9009\u62e9\u90e8\u95e8"},B.map((function(e){return s.a.createElement(O,{value:e._id,key:e._id},e.name)})))),s.a.createElement(p.a.Item,{colon:!1,wrapperCol:{offset:8}},s.a.createElement(h.a,{htmlType:"submit",type:"primary"},k?"\u4fdd\u5b58\u4fee\u6539":"\u6dfb\u52a0\u7528\u6237"),!k&&s.a.createElement(h.a,{className:"ml20",onClick:N,danger:!0},"\u6e05\u7a7a"),s.a.createElement(h.a,{className:"ml20",onClick:F,type:"ghost"},"\u53d6\u6d88")))))}))}}]);