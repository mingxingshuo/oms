(this.webpackJsonpoms=this.webpackJsonpoms||[]).push([[18],{176:function(e,t,r){"use strict";var n=r(177),a=r.n(n),s=r(178),o=r(203),u=r.n(o),c=r(85),i={toLoginPage:function(){c.a.warning("\u767b\u5f55\u4fe1\u606f\u5931\u6548\uff0c\u5373\u5c06\u8df3\u8f6c\u5230\u767b\u5f55\u9875"),setTimeout((function(){window.location.href="/admin/login?redirect="+encodeURIComponent(window.location.pathname),localStorage.clear(),sessionStorage.clear()}),1500)},message:c.a,storage:function(e){return{get:function(t){return"localStorage".indexOf(e)>-1?localStorage.getItem(t):sessionStorage.getItem(t)},set:function(t,r){return"localStorage".indexOf(e)>-1?localStorage.setItem(t,r):sessionStorage.setItem(t,r)}}}},l=i.storage("local").get("userInfo"),m=i.storage("local").get("menuList"),f=i.storage("local").get("token"),d=l&&m&&Date.now()-+new Date(JSON.parse(l).loginAt)<864e5;function g(e,t,r){return new Promise((function(n,a){u()({method:e,url:t,params:r}).then((function(e){return n(e.data)})).catch((function(e){return a(e)}))}))}function p(e,t,r){return new Promise((function(n,a){u()({method:e,url:t,data:r}).then((function(e){n(e.data)})).catch((function(e){return a(e)}))}))}u.a.defaults.timeout=1e4,u.a.defaults.headers={"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json;charset=utf-8",token:f},u.a.defaults.withcredentials=!0,u.a.interceptors.request.use((function(e){if(d||"/user/login"===e.url){var t=Date.now();return"get"===e.method||"delete"===e.method?e.url.indexOf("?")>=0?e.url+="&_t="+t:e.url+="?_t="+t:"post"!==e.method&&"put"!==e.method||(e.data._t=t),e}i.toLoginPage()}),(function(e){return Promise.reject(e)})),u.a.interceptors.response.use((function(e){return e}),(function(e){if(e&&e.response)switch(e.response.status){case 400:e.message="\u8bf7\u6c42\u53c2\u6570\u6709\u8bef";break;case 401:e.message="\u767b\u5f55\u4fe1\u606f\u5931\u6548\uff0c\u5373\u5c06\u8df3\u8f6c\u5230\u767b\u5f55\u9875",i.toLoginPage();break;case 403:e.message="\u62d2\u7edd\u8bbf\u95ee";break;case 404:e.message="\u6ca1\u6709\u67e5\u8be2\u5230\u6709\u5173\u6570\u636e";break;case 405:e.message="\u8bf7\u6c42\u65b9\u6cd5\u672a\u5141\u8bb8";break;case 408:e.message="\u8bf7\u6c42\u8d85\u65f6";break;case 500:e.message="\u670d\u52a1\u5668\u7aef\u51fa\u9519";break;case 501:e.message="\u7f51\u7edc\u672a\u5b9e\u73b0";break;case 502:e.message="\u7f51\u7edc\u9519\u8bef";break;case 503:e.message="\u670d\u52a1\u4e0d\u53ef\u7528";break;case 504:e.message="\u7f51\u7edc\u8d85\u65f6";break;case 505:e.message="http\u7248\u672c\u4e0d\u652f\u6301\u8be5\u8bf7\u6c42";break;default:e.message="\u8fde\u63a5\u9519\u8bef".concat(e.response.status),i.message.error(e.message)}else e.message="\u8fde\u63a5\u5230\u670d\u52a1\u5668\u5931\u8d25",i.message.error(e.message);return e.response.status>403&&i.message.error(e.message),Promise.reject(e.response.data)}));var h=function(){var e=Object(s.a)(a.a.mark((function e(t,r){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p("post",t,r);case 2:return n=e.sent,e.abrupt("return",Promise.resolve(n));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();t.a={get:function(e,t){var r=g("get",e,t);return Promise.resolve(r)},post:h,put:function(e,t){var r=p("put",e,t);return Promise.resolve(r)},delete:function(e,t){var r=g("delete",e,t);return Promise.resolve(r)}}},192:function(e,t,r){"use strict";r.d(t,"d",(function(){return a})),r.d(t,"c",(function(){return s})),r.d(t,"a",(function(){return o})),r.d(t,"f",(function(){return u})),r.d(t,"e",(function(){return c})),r.d(t,"b",(function(){return i}));var n=r(176),a=function(e){return n.a.post("/user/login",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))},s=function(e){return n.a.get("/user",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))},o=function(e){return n.a.post("/user",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))},u=function(e){return n.a.put("/user",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))},c=function(e){return n.a.put("/user/setDepartment",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))},i=function(e){return n.a.delete("/user",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))}},257:function(e,t,r){"use strict";r.d(t,"d",(function(){return a})),r.d(t,"a",(function(){return s})),r.d(t,"c",(function(){return o})),r.d(t,"e",(function(){return u})),r.d(t,"b",(function(){return c}));var n=r(176),a=function(e){return n.a.get("/department",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))},s=function(e){return n.a.post("/department",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))},o=function(e){return n.a.put("/department",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))},u=function(e){return Promise.resolve(e),n.a.put("/department/setManage",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))},c=function(e){return n.a.delete("/department",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))}},612:function(e,t,r){"use strict";r.r(t);var n=r(185),a=r(177),s=r.n(a),o=r(178),u=r(34),c=r(0),i=r.n(c),l=r(11),m=r(200),f=r(662),d=r(85),g=r(650),p=r(663),h=r(198),v=r(192),b=r(257),P=m.a.Option;t.default=Object(l.h)((function(e){var t=e.location,r=e.history,a=Object(c.useState)(""),l=Object(u.a)(a,2),O=l[0],k=l[1],w=Object(c.useState)(""),j=Object(u.a)(w,2),E=j[0],x=j[1],I=Object(c.useState)([]),S=Object(u.a)(I,2),T=S[0],C=S[1],y=i.a.createRef(),B=function(){var e=Object(o.a)(s.a.mark((function e(){var t,r,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.d)();case 2:t=e.sent,r=t.code,n=t.data,C(1===r?n:[]);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=Object(o.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.departmentId&&(t.departmentName=T.filter((function(e){return e._id===t.departmentId}))[0].name),f.a.confirm({title:E?"\u786e\u5b9a\u4fee\u6539\u8d26\u6237\u4fe1\u606f\u5417\uff1f":"\u786e\u5b9a\u521b\u5efa\u4e00\u4e2a\u65b0\u8d26\u6237\u5417\uff1f",onOk:function(){var e=Object(o.a)(s.a.mark((function e(){var r,a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!E){e.next=6;break}return e.next=3,Object(v.f)(Object(n.a)({},t,{id:E}));case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,Object(v.a)(t);case 8:e.t0=e.sent;case 9:r=e.t0,a=r.code,o=r.msg,1===a?t.departmentId?(_(),d.a.success(o)):(d.a.success("\u5bc6\u7801\u4fee\u6539\u6210\u529f\uff0c\u5373\u5c06\u8df3\u8f6c\u5230\u767b\u5f55\u9875"),setTimeout((function(){window.location.href="/admin/login",localStorage.clear()}),1500)):d.a.error(o);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),onCancel:function(){d.a.warning("\u64cd\u4f5c\u5df2\u53d6\u6d88")}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){y.current.resetFields(),x(""),k("")},_=function(){N(),r.goBack()},L=function(e){x(e._id),y.current.setFieldsValue(Object(n.a)({},e))};return Object(c.useEffect)((function(){var e=localStorage.getItem("role");k(e)}),[O]),Object(c.useEffect)((function(){N()}),[t.pathname]),Object(c.useEffect)((function(){-1===t.pathname.indexOf("/user/edit")&&B()}),[t.pathname]),Object(c.useEffect)((function(){if(t.pathname.indexOf("/user/edit")>-1){var e=JSON.parse(localStorage.getItem("userInfo"));L(e)}if(t.pathname.indexOf("/manage/edit")>-1){var n=t.query;if(n){var a=n.info;L(a)}else r.push("./add")}}),[t.pathname]),i.a.createElement("div",null,i.a.createElement("div",{className:"container"},i.a.createElement(g.a,Object.assign({},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:8}}},{ref:y,onFinish:q}),i.a.createElement(g.a.Item,{name:"username",label:"\u7528\u6237\u540d",validateTrigger:["onBlur","onChange"],rules:[{validator:function(e,t){return t?/[\u4E00-\u9FA5]/g.test(t)?Promise.reject("\u4e0d\u80fd\u8f93\u5165\u6c49\u5b57!"):Promise.resolve():Promise.reject("\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a")},validateTrigger:"onBlur"}],required:!0},i.a.createElement(p.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"})),i.a.createElement(g.a.Item,{name:"nickName",label:"\u6635\u79f0",validateTrigger:["onBlur","onChange"],rules:[{required:!0,message:"\u4e3a\u4e86\u65b9\u4fbf\u533a\u5206\uff0c\u8bf7\u4e3a\u8d26\u6237\u8bbe\u7f6e\u6635\u79f0(\u53ef\u4ee5\u7528\u4e2d\u6587)",validateTrigger:"onBlur"}]},i.a.createElement(p.a,{placeholder:"\u8bf7\u8f93\u5165\u6635\u79f0"})),t.pathname.indexOf("/user/edit")>-1?i.a.createElement(g.a.Item,{name:"password",label:"\u65b0\u5bc6\u7801",validateTrigger:["onBlur"],rules:[{min:9,max:16,message:"\u5bc6\u7801\u957f\u5ea6\u57289~16\u4f4d\u4e4b\u95f4",validateTrigger:["onBlur"]}]},i.a.createElement(p.a,{placeholder:"\u8bf7\u8f93\u5165\u65b0\u5bc6\u7801"})):i.a.createElement(g.a.Item,{name:"password",label:"\u5bc6\u7801",validateTrigger:["onBlur","onChange"],rules:[{required:!0,message:"\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a",validateTrigger:"onBlur"},{min:9,max:16,message:"\u5bc6\u7801\u957f\u5ea6\u57289~16\u4f4d\u4e4b\u95f4",validateTrigger:["onBlur","onChange"]}]},i.a.createElement(p.a,{disabled:!!E,placeholder:"\u8f93\u5165\u5bc6\u7801"})),i.a.createElement(g.a.Item,{name:"remarks",label:"\u5907\u6ce8",rules:[{required:!0,message:"\u5907\u6ce8\u4e0d\u80fd\u4e3a\u7a7a"}]},i.a.createElement(p.a,{placeholder:"\u8bf7\u8f93\u5165\u5907\u6ce8"})),"\u540e\u53f0\u7ba1\u7406\u5458\u8d26\u53f7"!==O&&-1===t.pathname.indexOf("/user/edit")&&i.a.createElement(g.a.Item,{label:"\u90e8\u95e8",name:"departmentId",validateTrigger:["onBlur","onChange"],rules:[{required:!0,message:"\u8bf7\u4e3a\u8be5\u8d26\u6237\u8bbe\u7f6e\u90e8\u95e8",validateTrigger:"onBlur"}]},i.a.createElement(m.a,{placeholder:"\u8bf7\u9009\u62e9\u90e8\u95e8"},T.map((function(e){return i.a.createElement(P,{value:e._id,key:e._id},e.name)})))),i.a.createElement(g.a.Item,{colon:!1,wrapperCol:{offset:8}},i.a.createElement(h.a,{htmlType:"submit",type:"primary"},E?"\u4fdd\u5b58\u4fee\u6539":"\u6dfb\u52a0\u7528\u6237"),!E&&i.a.createElement(h.a,{className:"ml20",onClick:N,danger:!0},"\u6e05\u7a7a"),i.a.createElement(h.a,{className:"ml20",onClick:_,type:"ghost"},"\u53d6\u6d88")))))}))}}]);