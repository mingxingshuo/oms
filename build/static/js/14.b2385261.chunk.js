(this.webpackJsonpoms=this.webpackJsonpoms||[]).push([[14],{454:function(e,t,n){"use strict";var r=n(170),a=n(89),c=n(453),o=n(0),i=n.n(o),l=n(706);t.a=function(e){var t=e.total,n=e.changePage,u=e.pagination,s=void 0===u?{}:u,d=e.keyWord,m=void 0===d?"order":d,f=Object(c.a)(e,["total","changePage","pagination","keyWord"]),p=Object(o.useState)(1),h=Object(a.a)(p,2),g=h[0],y=h[1],v={current:g,total:t,showTotal:function(e){return"\u5171 ".concat(e," \u6761")},showQuickJumper:!0,position:["bottomCenter"],onChange:function(e){console.log(e),sessionStorage.setItem(m+"PageNum",e),y(e),n(e)}};return i.a.createElement(l.a,Object.assign({pagination:!!s&&Object(r.a)({},v,{},s)},f))}},503:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"g",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return s}));var r=n(63),a=function(e){return r.a.get("/order/find",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))},c=function(e){return r.a.post("/order/create",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))},o=function(e){return r.a.get("/order/submit",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))},i=function(e){return r.a.get("/order/confirm",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))},l=function(e){return r.a.get("/order/route",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))},u=function(e){return r.a.get("/order/findOne",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))},s=function(e){return r.a.get("/order/review",e).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.resolve(e)}))}},674:function(e,t,n){},713:function(e,t,n){"use strict";n.r(t);var r=n(49),a=n.n(r),c=n(71),o=n(89),i=n(0),l=n.n(i),u=n(47),s=n(438),d=n(711),m=n(709),f=n(175),p=n(37),h=n(69),g=n(436),y=n(712),v=n(720),b=n(719),O=n(718),k=n(461),E=n.n(k),j=(n(472),n(454)),w=n(170),x=n(548),I=n(723),C=n(453),S=n(708),_=function(e){var t=e.type,n=void 0===t?"view":t,r=e.src,a=Object(C.a)(e,["type","src"]);return"view"===n?r?l.a.createElement("img",{src:r,alt:"miss"}):"\u65e0":l.a.createElement(S.a,Object.assign({name:"imageFile",showUploadList:!1},a),r?l.a.createElement("img",{src:r,alt:"miss"}):l.a.createElement(p.a,null,"\u4e0a\u4f20\u4ed8\u6b3e\u622a\u56fe"))},P=n(63),N=(n(668),{orderid:"",sum:0,info:[{type:"\u652f\u4ed8\u5b9d\u6536\u6b3e",money:0,url:""},{type:"\u5fae\u4fe1\u6536\u6b3e",money:0,url:""},{type:"\u94f6\u884c\u5361\u6536\u6b3e",money:0,url:""},{type:"\u4ee3\u6536\u6536\u6b3e",money:0,url:""},{type:"\u5df2\u7ed3\u5b58\u6536\u6b3e",money:0,url:""},{type:"\u540e\u7f6e\u6536\u6b3e",money:0,url:""}]}),z=["\u4ee3\u6536\u6536\u6b3e","\u5df2\u7ed3\u5b58\u6536\u6b3e","\u540e\u7f6e\u6536\u6b3e"],A="\u9500\u552e\u8d26\u53f7"===localStorage.getItem("role"),D=function(e){var t=Object(i.useState)(!1),n=Object(o.a)(t,2),r=n[0],u=n[1],s=Object(i.useState)(!1),d=Object(o.a)(s,2),m=d[0],f=d[1],y=Object(i.useState)(Object(w.a)({},N)),v=Object(o.a)(y,2),b=v[0],O=v[1],k=e.payInfo,E=e.setPayInfo,j=k.info,C=k.sum,S=function(){u(!1),E({})},D=function(e){for(var t=e.info,n=e.sum,r=0,a=!1,c="",o=0;o<t.length;o++){var i=t[o],l=i.money,u=i.url,s=i.type,d=-1===z.indexOf(s);r+=l,l>0&&d&&!u&&!a&&(a=!0,c=s)}return r!==n?{checkOk:!1,msg:"\u4ed8\u6b3e\u8be6\u60c5\u4e2d\u4e2a\u6b3e\u9879\u7684\u548c\u5e94\u7b49\u4e8e\u603b\u91d1\u989d"}:a?{msg:c+"\u7f3a\u5c11\u622a\u56fe",checkOk:!1}:{checkOk:!0}},F=function(){f(!1)},T=l.a.createElement(x.a,{bordered:!0,column:1,size:"small"},l.a.createElement(x.a.Item,{label:"\u4ed8\u6b3e\u603b\u91d1\u989d"},C||"\u6682\u65e0\u4ed8\u6b3e\u4fe1\u606f\uff0c\u8bf7\u4fee\u6539\u5b8c\u5584\u4ed8\u6b3e\u4fe1\u606f"),l.a.createElement(x.a.Item,{label:"\u4ed8\u6b3e\u660e\u7ec6"},j&&j.length?l.a.createElement(x.a,{bordered:!0,size:"small",className:"pay-info-detail",column:5},j.map((function(e,t){var n=e.type,r=e.money,a=e.url;return r>0&&l.a.createElement(i.Fragment,{key:n+t},l.a.createElement(x.a.Item,{label:n,span:2},r),l.a.createElement(x.a.Item,{span:3},l.a.createElement(_,{action:"http://n.nyzda.top/pay/upload",src:a})))}))):C?l.a.createElement(x.a,{bordered:!0,size:"small",className:"pay-info-detail",column:5},l.a.createElement(x.a.Item,{label:"\u4ee3\u6536\u8d27\u6b3e",span:2},C)):null)),J=l.a.createElement(l.a.Fragment,null,l.a.createElement(x.a,{bordered:!0,column:1,size:"small"},l.a.createElement(x.a.Item,{label:"\u4ed8\u6b3e\u603b\u91d1\u989d"},l.a.createElement(I.a,{step:.01,min:0,value:b.sum,onChange:function(e){O(Object(w.a)({},b,{sum:e}))}})),l.a.createElement(x.a.Item,{label:l.a.createElement("div",null,l.a.createElement("span",null,"\u4ed8\u6b3e\u660e\u7ec6"),l.a.createElement("p",{className:"tips"},"\u63d0\u793a\uff1a\u6536\u6b3e\u91d1\u989d\u8bbe\u7f6e\u4e3a0\u65f6\uff0c\u4f1a\u6e05\u7a7a\u4ed8\u6b3e\u622a\u56fe"))},l.a.createElement(x.a,{bordered:!0,size:"small",className:"pay-info-detail",column:5},b.info.map((function(e,t){var n=e.type,r=e.url,a=e.money;return l.a.createElement(i.Fragment,{key:t},l.a.createElement(x.a.Item,{label:n,span:2},l.a.createElement(I.a,{step:.01,min:0,value:a,onChange:function(e){return function(e,t){var n=b.info.filter((function(e){return e.type===t}))[0];n.money=e,0===e&&(n.url=""),O(Object(w.a)({},b))}(e,n)}})),l.a.createElement(x.a.Item,{span:3},-1===z.indexOf(n)?l.a.createElement(_,{action:"http://n.nyzda.top/pay/upload",type:"update",src:r,onChange:function(e){return function(e,t){(console.log(e),"done"===e.status)&&(b.info.filter((function(e){return e.type===t}))[0].url="http://n.nyzda.top/uploads/"+e.response.image_url,O(Object(w.a)({},b)))}(e.file,n)}}):"\u65e0"))}))))));return Object(i.useEffect)((function(){u(!0)}),[]),l.a.createElement(g.a,{title:"\u4ed8\u6b3e\u4fe1\u606f",visible:r,onCancel:S,width:640,style:{top:30},className:"pay-info-modal",footer:m?l.a.createElement("div",null,l.a.createElement(p.a,{type:"primary",ghost:!0,onClick:F},"\u53d6\u6d88"),l.a.createElement(p.a,{type:"primary",onClick:function(){var e=D(b);e.checkOk?g.a.confirm({title:"\u662f\u5426\u4fdd\u5b58\u4fee\u6539",onOk:function(){var e=Object(c.a)(a.a.mark((function e(){var t,n,r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a=Object(w.a)({},b),P.a.put("/pay",a).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.reject(e)}));case 2:t=e.sent,n=t.code,r=t.msg,c=t.data,1===n?(h.a.success(r),E(c),F()):h.a.error(r);case 7:case"end":return e.stop()}var a}),e)})));return function(){return e.apply(this,arguments)}}(),onCancel:function(){h.a.warning("\u5df2\u53d6\u6d88\u64cd\u4f5c")}}):h.a.warning(e.msg)}},"\u4fdd\u5b58")):l.a.createElement("div",null,A&&l.a.createElement(p.a,{type:"primary",ghost:!0,onClick:function(){O(Object(w.a)({},b,{},k)),f(!0)}},"\u4fee\u6539"),l.a.createElement(p.a,{type:"primary",onClick:S},"\u786e\u5b9a"))},m?J:T)},F=n(503),T=(n(674),s.a.Search),J=d.a.Step,R=m.a.Text;E.a.locale("zh-cn");function B(e){var t=e.filter((function(e){return"COD"===e.name}));return e.length&&t.length?t.length?"\r\n\u4ee3\u6536\u91d1\u989d\uff1a".concat(t[0].value):void 0:""}t.default=Object(u.g)((function(e){var t=e.location,n=e.history,r=Object(i.useState)("\u4e3b\u8d26\u53f7"),u=Object(o.a)(r,2),s=u[0],m=u[1],k=Object(i.useState)(""),w=Object(o.a)(k,2),x=w[0],I=w[1],C=Object(i.useState)({}),S=Object(o.a)(C,2),_=S[0],N=S[1],z=Object(i.useState)([]),A=Object(o.a)(z,2),W=A[0],q=A[1],K=Object(i.useState)(0),L=Object(o.a)(K,2),Q=L[0],U=L[1],G=Object(i.useState)([]),H=Object(o.a)(G,2),M=H[0],V=H[1],X=Object(i.useState)(!1),Y=Object(o.a)(X,2),Z=Y[0],$=Y[1],ee=[{key:"orderid",dataIndex:"orderid",title:"\u8ba2\u5355\u53f7",align:"center",fixed:"left",width:150,render:function(e,t){return l.a.createElement(R,{copyable:{text:"\u5730\u5740\uff1a".concat(t.d_address," | \n                                    \r\n\u59d3\u540d\uff1a").concat(t.d_contact," | \n                                    \r\n\u7535\u8bdd\uff1a").concat(t.d_tel," | \n                                    \r\n\u4e0b\u5355\uff1a").concat(t.Cargo.map((function(e){return"".concat(e.count,"-").concat(e.name," ")})).join(",")).concat(B(t.AddedService)?" | ":"","\n                                    ").concat(B(t.AddedService))}},l.a.createElement(f.a,{title:"\u590d\u5236\u8ba2\u5355\u4fe1\u606f"},e))}},{key:"mailno",dataIndex:"mailno",title:"\u987a\u4e30\u8fd0\u5355\u53f7",width:90,align:"center",fixed:"left",render:function(e){return e||"\u4e0b\u5355\u540e\u5373\u53ef\u751f\u6210\u8fd0\u5355\u53f7"}},{key:"dealtype",dataIndex:"dealtype",title:"\u8ba2\u5355\u72b6\u6001",width:80,align:"center",render:function(e){return l.a.createElement("div",{className:"order-status"},l.a.createElement("span",{className:0===e?"info":1===e?"complete":"cancel"},0===e?"\u672a\u4e0b\u5355":1===e?"\u5df2\u4e0b\u5355":"\u5df2\u53d6\u6d88"))}},{title:"\u7269\u54c1\u4fe1\u606f",children:[{key:"name",dataIndex:"Cargo",title:"\u8d27\u54c1\u540d\u79f0",align:"center",width:100,render:function(e){return e&&e.length?l.a.createElement("ul",{className:"cargo-list"},e.map((function(e,t){return l.a.createElement("li",{key:e.name+t},e.name)}))):{children:"\u6682\u65e0\u8d27\u54c1\u4fe1\u606f",props:{colSpan:2}}}},{key:"count",dataIndex:"Cargo",title:"\u8d27\u54c1\u6570\u91cf",align:"center",width:100,render:function(e){return e&&e.length?l.a.createElement("ul",{className:"cargo-list"},e.map((function(e,t){return l.a.createElement("li",{key:e.count+""+t},e.count)}))):{props:{colSpan:0}}}}]},{title:"\u5bc4\u4ef6\u4eba\u4fe1\u606f",children:[{key:"j_company",dataIndex:"j_company",title:"\u5bc4\u4ef6\u4eba\u516c\u53f8\u540d\u79f0",width:100,align:"center"},{key:"j_contact",dataIndex:"j_contact",title:"\u5bc4\u4ef6\u4eba\u59d3\u540d",width:80,align:"center"},{key:"j_tel",dataIndex:"j_tel",title:"\u5bc4\u4ef6\u4eba\u8054\u7cfb\u7535\u8bdd",width:110,align:"center"},{key:"j_address",dataIndex:"j_address",title:"\u5bc4\u4ef6\u4eba\u8be6\u7ec6\u5730\u5740",align:"center",width:150}]},{title:"\u6536\u4ef6\u4eba\u4fe1\u606f",children:[{key:"d_company",dataIndex:"d_company",title:"\u6536\u4ef6\u4eba\u516c\u53f8\u540d\u79f0",width:100,align:"center"},{key:"d_contact",dataIndex:"d_contact",title:"\u6536\u4ef6\u4eba\u59d3\u540d",width:80,align:"center"},{key:"d_tel",dataIndex:"d_tel",title:"\u6536\u4ef6\u4eba\u8054\u7cfb\u7535\u8bdd",width:110,align:"center"},{key:"d_address",dataIndex:"d_address",title:"\u6536\u4ef6\u4eba\u8be6\u7ec6\u5730\u5740",align:"center",width:150}]},{title:"\u589e\u503c\u670d\u52a1",children:[{key:"AddedService",dataIndex:"AddedService",title:"\u662f\u5426\u4ee3\u6536\u8d27\u6b3e",align:"center",width:80,render:function(e){return e.filter((function(e){return"COD"===e.name})).length?l.a.createElement(v.a,{twoToneColor:"#52c41a"}):l.a.createElement(b.a,null)}},{key:"value",dataIndex:"AddedService",title:"\u4ee3\u6536\u8d27\u6b3e\u91d1\u989d",align:"center",width:80,render:function(e){return e.filter((function(e){return"COD"===e.name})).length?e.filter((function(e){return"COD"===e.name}))[0].value:"\u2014\u2014"}},{key:"value1",dataIndex:"AddedService",title:"\u4ee3\u6536\u8d27\u6b3e\u5361\u53f7",align:"center",width:150,render:function(e){return e.filter((function(e){return"COD"===e.name})).length?e.filter((function(e){return"COD"===e.name}))[0].value1:"\u2014\u2014"}}]},{title:"\u8ba2\u5355\u65f6\u95f4",children:[{key:"createAt",dataIndex:"createAt",title:"\u4e0b\u5355\u65f6\u95f4",align:"center",width:120,render:function(e){return E()(e).format("llll")}},{key:"updateAt",dataIndex:"updateAt",title:"\u6700\u8fd1\u4e00\u6b21\u4fee\u6539",align:"center",width:120,render:function(e){return E()(e).format("llll")}},{key:"sendstarttime",dataIndex:"sendstarttime",title:"\u4e0a\u95e8\u53d6\u4ef6\u65f6\u95f4",align:"center",width:120,render:function(e){return E()(e).format("llll")}}]},{key:"pay",dataIndex:"orderid",title:"\u4ed8\u6b3e\u4fe1\u606f",align:"center",width:80,fixed:"right",render:function(e){return l.a.createElement(p.a,{type:"link",onClick:function(){return ce(e)}},"\u67e5\u770b")}},{key:"action",dataIndex:"action",title:"\u64cd\u4f5c",width:"\u4e3b\u8d26\u53f7"===s?0:100,fixed:"right",align:"center",render:function(e,t){return te(t)}}],te=function(e){var t;return"\u7ba1\u7406\u8d26\u53f7"===s&&(t=e.isReview?"\u5ba1\u6838\u901a\u8fc7":l.a.createElement(p.a,{type:"link",onClick:function(){return ae(e.orderid)}},"\u5ba1\u6838")),"\u9500\u552e\u8d26\u53f7"===s&&(t=e.mailno?l.a.createElement(l.a.Fragment,null,l.a.createElement(p.a,{type:"link",onClick:function(){return re(e.orderid)}},"\u5b9e\u65f6\u7269\u6d41"),l.a.createElement(p.a,{type:"link",onClick:function(){return le(e)},danger:!0},"\u53d6\u6d88\u8ba2\u5355")):e.isReview?"\u5df2\u4e0b\u5355":"\u7b49\u5f85\u5ba1\u6838"),t},ne={width:360},re=function(){var e=Object(c.a)(a.a.mark((function e(t){var n,r,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(F.f)({tracking_number:t,tracking_type:2});case 2:n=e.sent,r=n.code,c=n.msg,o=n.data,1===r?(V(o.reverse()),$(!0)):h.a.error(c);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g.a.confirm({title:"\u901a\u8fc7\u5ba1\u6838\uff1f",onOk:function(){var e=Object(c.a)(a.a.mark((function e(){var n,r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(F.a)({orderid:t});case 2:n=e.sent,r=n.code,c=n.msg,1===r?(h.a.success(c),ie()):h.a.error(c);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),onCancel:function(){h.a.warning("\u5df2\u53d6\u6d88\u64cd\u4f5c")}});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=Object(c.a)(a.a.mark((function e(t){var n,r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a={orderid:t},P.a.get("/pay",a).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.reject(e)}));case 2:n=e.sent,r=n.code,n.msg,c=n.data,N(1===r?c:{orderid:t});case 7:case"end":return e.stop()}var a}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=Object(c.a)(a.a.mark((function e(t){var n,r,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(F.d)({orderid:t});case 2:n=e.sent,r=n.code,c=n.msg,o=n.data,console.log(r),1===r?(h.a.success(c),q(o),U(1)):ie();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=Object(c.a)(a.a.mark((function e(t){var n,r,c,o,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=sessionStorage.getItem("orderPageNum")||1,t&&I(t),e.next=4,Object(F.e)({page:n,customerId:t||x});case 4:r=e.sent,c=r.code,o=r.data,i=r.count,1===c?(q(o),U(i)):x&&1!==c&&ue();case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=function(e){g.a.confirm({title:l.a.createElement("h3",{className:"order-modal-title"},l.a.createElement(O.a,{className:"mr10"}),"\u63d0\u793a\uff1a"),content:l.a.createElement("p",{className:"order-modal-content"},"\u53d6\u6d88\u8ba2\u5355\u540e\uff0c\u8be5\u8ba2\u5355\u5c06\u4e0d\u518d\u663e\u793a\u5728\u60a8\u7684\u5217\u8868\u4e2d\uff0c\u5e76\u4e14\u987a\u4e30\u4e5f\u4e0d\u518d\u63a5\u5355\uff0c\u786e\u8ba4\u7ee7\u7eed\u64cd\u4f5c\u5417\uff1f"),style:{top:"30%"},onOk:function(){var t=Object(c.a)(a.a.mark((function t(){var n,r,c,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.orderid,t.next=3,Object(F.b)({orderid:n,dealtype:2});case 3:r=t.sent,c=r.code,o=r.msg,1===c?h.a.success("\u72b6\u6001\u4fee\u6539\u6210\u529f"):h.a.error(o);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),onCancel:function(){h.a.warning("\u5df2\u53d6\u6d88\u64cd\u4f5c")}})},ue=function(){setTimeout((function(){n.goBack()}),500)};return Object(i.useEffect)((function(){var e=localStorage.getItem("role"),n=t.query,r=t.pathname,a=n?n.customerId:"";r.indexOf("/customer/order/list")>-1&&!n?ue():(m(e),ie(a))}),[]),l.a.createElement("div",{className:"order-list"},l.a.createElement("div",{className:"container"},l.a.createElement(j.a,{rowKey:function(e){return e._id},dataSource:W,columns:ee,total:Q,size:"small",bordered:!0,scroll:{x:"max-content",y:400,scrollToFirstRowOnChange:!0},changePage:ie,title:function(){return l.a.createElement(T,{style:ne,placeholder:"\u8bf7\u8f93\u5165\u8ba2\u5355\u53f7",enterButton:"\u67e5\u8be2",onSearch:oe,allowClear:!0})}})),Z&&l.a.createElement(y.a,{placement:"left",closable:!1,onClose:$(!1),visible:Z},l.a.createElement(d.a,{progressDot:!0,current:M.length,direction:"vertical",size:"small"},M.map((function(e){return l.a.createElement(J,{key:e.accept_time,title:e.accept_address,description:e.accept_time+e.remark})})))),_.orderid&&l.a.createElement(D,{payInfo:_,setPayInfo:N}))}))}}]);